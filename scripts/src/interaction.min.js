import{currentlyLoadedApplets}from"../applets/applet.min.js";import{removeHoverEvents}from"./hoverEvents.min.js";import{addTemporaryListener}from"./main.min.js";let currentlyTouchDevice="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,lastMousemoveEvent=0;function initInteractionListeners(){var e=handleTouchEvent.bind(this);document.documentElement.addEventListener("touchstart",e,!1),document.documentElement.addEventListener("touchmove",e,!1),document.documentElement.addEventListener("mousemove",()=>{var e;currentlyTouchDevice&&(e=Date.now()-lastMousemoveEvent,lastMousemoveEvent=Date.now(),3<=e)&&e<=50&&33!=e&&(currentlyTouchDevice=!1)}),document.documentElement.addEventListener("keydown",e=>{"Enter"!==e.key||"BUTTON"===document.activeElement.tagName||"INPUT"===document.activeElement.tagName&&"button"!==document.activeElement.getAttribute("type")||document.activeElement.click()}),document.documentElement.addEventListener("pointerdown",()=>{"INPUT"===document.activeElement.tagName&&"range"!==document.activeElement.type||"TEXTAREA"===document.activeElement.tagName||document.activeElement.blur()}),document.documentElement.addEventListener("pointerup",()=>{"INPUT"===document.activeElement.tagName&&"range"!==document.activeElement.type||"TEXTAREA"===document.activeElement.tagName||document.activeElement.blur()})}function handleTouchEvent(){"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName&&"SELECT"!==document.activeElement.tagName&&document.activeElement.blur(),currentlyTouchDevice||(removeHoverEvents(),currentlyTouchDevice=!0)}function listenForFullscreenKey(){addTemporaryListener({object:document.documentElement,event:"keydown",callback:e=>{if("f"===e.key&&!(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey)&&"INPUT"!==document.activeElement.tagName&&"TEXTAREA"!==document.activeElement.tagName){let e=1/0,t=0;for(let n=0;n<currentlyLoadedApplets.length;n++){var o=currentlyLoadedApplets[n];if(o.allowFullscreenWithKeyboard){var c=o.wilsonForFullscreen??o.wilson;if(c.currentlyFullscreen)return void c.exitFullscreen();c=o.canvas.getBoundingClientRect(),o=c.top+c.height/2,c=Math.abs(window.innerHeight/2-o);c<e&&(e=c,t=n)}}(currentlyLoadedApplets[t].wilsonForFullscreen??currentlyLoadedApplets[t].wilson).enterFullscreen()}}})}export{currentlyTouchDevice,initInteractionListeners,listenForFullscreenKey};