<header><div id="logo"><a href="/home/" tabindex="-1"><img src="/graphics/general-icons/logo.webp" alt="Logo" tabindex="1"></img></a></div><div style="height: 20px"></div><h1 class="heading-text">Section 10: Intro to Markov Chains</h1></header><main><section><div class="text-buttons nav-buttons"><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button previous-nav-button" type="button" tabindex="-1">Previous</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button home-nav-button" type="button" tabindex="-1">Home</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button next-nav-button" type="button" tabindex="-1">Next</button></div></div><p class="body-text">With so much theory developed, let&#x2019;s take this last section to explore one of the most important applications of linear algebra. While one of the most ubiquitous applications in modern technology is in graphics, where the function that maps any triangle in 3D space to its image on a fixed 2D screen is a linear map (called a <em>projection map</em>). With very few exceptions, this is the foundation of how every 3D game is implemented.</p><p class="body-text">Our first application will be to a different area, though, closer to statistics. Let&#x2019;s say that we have a collection of <strong>states</strong> <span class="tex-holder inline-math" data-source-tex="x_1, ..., x_n">$x_1, ..., x_n$.</span> These are states of matter or being &mdash; for example, in <a href="https://www.youtube.com/watch?v=LL3kVtc-4vY">Belousov-Zhabotinsky reaction</a>, <span class="tex-holder inline-math" data-source-tex="x_1">$x_1$</span> might represent a molecule of malonic acid and <span class="tex-holder inline-math" data-source-tex="x_2">$x_2$</span> a molecule of potassium bromate (in reality, we&#x2019;d need many more variables for the intermediate states in the reaction).This system, and many like it, fall into a particular class that lend themselves extremely well to linear algebra:</p><div class="notes-def notes-environment"><div class="notes-def-title notes-title">Definition: Markov chain</div><p class="body-text">Let <span class="tex-holder inline-math" data-source-tex="x_1, ..., x_n">$x_1, ..., x_n$</span> be a collection of states and let <span class="tex-holder inline-math" data-source-tex="\vec{x} \in \mathbb{R}^n">$\vec{x} \in \mathbb{R}^n$</span> be a vector representing the amount of the system in each state. If the system evolves over time as a function <span class="tex-holder inline-math" data-source-tex="\vec{x}(t)">$\vec{x}(t)$,</span> but the value of <span class="tex-holder inline-math" data-source-tex="\vec{x}(t)">$\vec{x}(t)$</span> is a linear function of <span class="tex-holder inline-math" data-source-tex="\vec{x}(t - 1)">$\vec{x}(t - 1)$</span> and no other factors, then we call <span class="tex-holder inline-math" data-source-tex="\vec{x}(t)">$\vec{x}(t)$</span> a <strong>Markov chain</strong>.</p></div><p class="body-text">A Markov chain is defined by an <span class="tex-holder inline-math" data-source-tex="n \times n">$n \times n$</span> matrix <span class="tex-holder inline-math" data-source-tex="P">$P$,</span> called a <strong>transition matrix</strong>, such that</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]P\vec{x}(t) = \vec{x}(t + 1).[NEWLINE]$$">$$\begin{align*}P\vec{x}(t) = \vec{x}(t + 1).\end{align*}$$</span></p><p class="body-text">There&#x2019;s a surprising amount of information we can extract from just this description &mdash; let&#x2019;s see it in action.</p><div class="notes-ex notes-environment"><div class="notes-ex-title notes-title">Example: Markov chain</div><p class="body-text">A particular university has exclusively math, physics, and computer science majors, and doesn&#x2019;t allow double majors. Every year, 5% of the math majors at the university switch to a physics major, and 10% switch to computer science. On the other hand, 10% of the physics majors switch to math and 15% to computer science. 5% of the computer science majors switch to math, and 15% to physics. If there are initially 100 students in each of the three majors and no one ever graduates, how many will be in each major after 2 years?</p><p class="body-text">The three states here are being a math, physics, and computer science major. The state vector is initially</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\vec{x}(0) = \left[\begin{array}{c} 100 \\ 100 \\ 100 \end{array}\right],[NEWLINE]$$">$$\begin{align*}\vec{x}(0) = \left[\begin{array}{c} 100 \\ 100 \\ 100 \end{array}\right],\end{align*}$$</span></p><p class="body-text">representing the equal quantity of students in each major. The state matrix updates <span class="tex-holder inline-math" data-source-tex="\vec{x}(0)">$\vec{x}(0)$</span> to <span class="tex-holder inline-math" data-source-tex="\vec{x}(1)">$\vec{x}(1)$</span> &mdash; i.e. the proportion in each major after a year &mdash; by matrix multiplication, so we should have</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="\begin{align*}[NEWLINE][TAB]P = \left[\begin{array}{ccc} 0.85& 0.1& 0.05 \\ 0.05& 0.75& 0.15 \\ 0.1& 0.15& 0.8 \end{array}\right].[NEWLINE]\end{align*}">$$\begin{align*}P = \left[\begin{array}{ccc} 0.85& 0.1& 0.05 \\ 0.05& 0.75& 0.15 \\ 0.1& 0.15& 0.8 \end{array}\right].\end{align*}$$</span></p><p class="body-text">The entry in row <span class="tex-holder inline-math" data-source-tex="i">$i$</span> and column <span class="tex-holder inline-math" data-source-tex="j">$j$</span> is the proportion of students in major <span class="tex-holder inline-math" data-source-tex="j">$j$</span> who switch to major <span class="tex-holder inline-math" data-source-tex="i">$i$</span> &mdash; when we do the matrix multiplication, multiplying the second row by <span class="tex-holder inline-math" data-source-tex="\vec{x}(0)">$\vec{x}(0)$</span> gives us</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB](0.05)(100) + 0.75(100) + 0.15(100) = 5 + 75 + 15 = 95,[NEWLINE]$$">$$\begin{align*}(0.05)(100) + 0.75(100) + 0.15(100) = 5 + 75 + 15 = 95,\end{align*}$$</span></p><p class="body-text">indicating that 5 math majors and 15 computer science majors switched to physics, and 75 physics majors &#x201C;switched&#x201D; to physics (i.e. stayed there). Since any given column of <span class="tex-holder inline-math" data-source-tex="P">$P$</span> consists of the proportions of all the students coming from a given major, every column should have entries that sum to 1. In total, our matrix product we want is</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="\begin{align*}[NEWLINE][TAB]\vec{x}(1) &= P\vec{x}(0)\\[NEWLINE][TAB]&= \left[\begin{array}{ccc} 0.85& 0.1& 0.05 \\ 0.05& 0.75& 0.15 \\ 0.1& 0.15& 0.8 \end{array}\right]\left[\begin{array}{c} 100 \\ 100 \\ 100 \end{array}\right]\\[NEWLINE][TAB]&= \left[\begin{array}{c} 100 \\ 95 \\ 105 \end{array}\right]\\[NEWLINE][TAB]\vec{x}(2) &= P\vec{x}(1)\\[NEWLINE][TAB]&= \left[\begin{array}{ccc} 0.85& 0.1& 0.05 \\ 0.05& 0.75& 0.15 \\ 0.1& 0.15& 0.8 \end{array}\right]\left[\begin{array}{c} 100 \\ 95 \\ 105 \end{array}\right]\\[NEWLINE][TAB]&= \left[\begin{array}{c} 99.75 \\ 92 \\ 108.25 \end{array}\right].[NEWLINE]\end{align*}">$$\begin{align*}\vec{x}(1) &= P\vec{x}(0)\\[4px]&= \left[\begin{array}{ccc} 0.85& 0.1& 0.05 \\ 0.05& 0.75& 0.15 \\ 0.1& 0.15& 0.8 \end{array}\right]\left[\begin{array}{c} 100 \\ 100 \\ 100 \end{array}\right]\\[4px]&= \left[\begin{array}{c} 100 \\ 95 \\ 105 \end{array}\right]\\[4px]\vec{x}(2) &= P\vec{x}(1)\\[4px]&= \left[\begin{array}{ccc} 0.85& 0.1& 0.05 \\ 0.05& 0.75& 0.15 \\ 0.1& 0.15& 0.8 \end{array}\right]\left[\begin{array}{c} 100 \\ 95 \\ 105 \end{array}\right]\\[4px]&= \left[\begin{array}{c} 99.75 \\ 92 \\ 108.25 \end{array}\right].\end{align*}$$</span></p><p class="body-text">The numbers are a little wonky, but the idea is clear: iterating <span class="tex-holder inline-math" data-source-tex="P">$P$</span> moves us forward in time, and if we had 1000 states rather than 3 and a computer capable of processing a matrix that large, we could begin to draw some truly novel insights.</p></div><div class="notes-exc notes-environment"><div class="notes-exc-title notes-title">Exercise: a Markov chain</div><p class="body-text">People occasionally change the type of computer they use, albeit very rarely. Suppose each year, 3% of users running macOS switch to Windows, and 1% to Linux, 3% of Windows users switch to macOS and 1% to Linux, and 3% of Linux users switch to macOS, as well as 3% to Windows. The current proportion of desktop operating systems among those three is 78% Windows, 19% Mac, and 3% Linux. What does our (unrealistic) model predict will be the proportion of each in 2 years?</p></div><p class="body-text">One of the most important proprtties of Markov chains is their ability to make predictions about the limiting behavior of a system (that is, <span class="tex-holder inline-math" data-source-tex="\lim_{t \to \infty} \vec{x}(t)">$\lim_{t \to \infty} \vec{x}(t)$).</span> A <strong>steady-state vector</strong> is a vector <span class="tex-holder inline-math" data-source-tex="\vec{q}">$\vec{q}$</span> for which <span class="tex-holder inline-math" data-source-tex="P\vec{q} = \vec{q}">$P\vec{q} = \vec{q}$,</span> meaning the system no longer changes. The amount of students in each major stays exactly the same, or the number of people using each OS stays constant. Importantly, we&#x2019;re not saying that no one ever changes majors or computers &mdash; the matrix <span class="tex-holder inline-math" data-source-tex="P">$P$</span> in both the past examples is constant, so there will always be some people moving between states. Instead, we&#x2019;re after a vector <span class="tex-holder inline-math" data-source-tex="\vec{x}">$\vec{x}$</span> of a distribution across the states for which the inflow and outflow for each state are equal. Remarkably, as long as we&#x2019;re somewhat sensible in constructing our transition matrix, steady-state vectors will be present, unique, and useful.</p><div class="notes-thm notes-environment"><div class="notes-thm-title notes-title">Theorem: steady-state vectors in Markov chains</div><p class="body-text">Let <span class="tex-holder inline-math" data-source-tex="P">$P$</span> be a transition matrix for a Markov chain so that for some integer <span class="tex-holder inline-math" data-source-tex="k">$k$,</span> <span class="tex-holder inline-math" data-source-tex="P^k">$P^k$</span> contains only positive entries (for our examples, <span class="tex-holder inline-math" data-source-tex="k">$k$</span> will be <span class="tex-holder inline-math" data-source-tex="1">$1$,</span> meaning <span class="tex-holder inline-math" data-source-tex="P">$P$</span> contains only positive entries). Then <span class="tex-holder inline-math" data-source-tex="P">$P$</span> has a unique steady-state vector <span class="tex-holder inline-math" data-source-tex="\vec{q}">$\vec{q}$.</span> Moreover, <span class="tex-holder inline-math" data-source-tex="\lim_{t \to \infty} P^t \vec{x} = \vec{q}">$\lim_{t \to \infty} P^t \vec{x} = \vec{q}$</span> for <em>any</em> vector <span class="tex-holder inline-math" data-source-tex="\vec{x}">$\vec{x}$,</span> so the system converges to its steady-state vector regardless of the starting configuration of the state.</p></div><p class="body-text">This theorem guarantees that searching for a steady-state vector is worth our time since a unique one will always exist, and it also tells us why it&#x2019;s useful to find one &mdash; it&#x2019;s the limiting behavior of the system (in the language of differential equations, we might say it&#x2019;s a convergent equilibrium).</p><p class="body-text">To find a steady-state vector, we want to solve <span class="tex-holder inline-math" data-source-tex="P\vec{q} = \vec{q}">$P\vec{q} = \vec{q}$,</span> so <span class="tex-holder inline-math" data-source-tex="(P - I)\vec{q} = \vec{0}">$(P - I)\vec{q} = \vec{0}$.</span> That should hopefully look familiar from a past homework &mdash; we&#x2019;re finding an eigenvector with eigenvalue <span class="tex-holder inline-math" data-source-tex="\lambda = 1">$\lambda = 1$.</span> When we found all possible eigenvectors, we had to solve the characteristic polynomial for all the possible eigenvectors and then handle them one-by-one, but this time around we already know the eigenvalue we&#x2019;re interested in, and that there should be exactly one eigenvector corresponding to it. Once again, we&#x2019;re just doing row-reduction.</p><div class="notes-ex notes-environment"><div class="notes-ex-title notes-title">Example: a steady-state solution</div><p class="body-text">For the university example from before, how many students will be in each major in the long run?</p><p class="body-text">We&#x2019;re solving <span class="tex-holder inline-math" data-source-tex="P - I = \vec{0}">$P - I = \vec{0}$,</span> so we have</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="\begin{align*}[NEWLINE][TAB]\left[\begin{array}{ccc|c} 0.85 - 1& 0.1& 0.05 & 0 \\ 0.05& 0.75 - 1& 0.15 & 0 \\ 0.1& 0.15& 0.8 - 1 & 0 \end{array}\right] &\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} -0.15& 0.1& 0.05 & 0 \\ 0.05& -0.25& 0.15 & 0 \\ 0.1& 0.15& -0.2 & 0 \end{array}\right] &\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} -3& 2& 1 & 0 \\ 1& -5& 3 & 0 \\ 2& 3& -4 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_1} \ \times\!\!= 20 \\ \vec{r_2} \ \times\!\!= 20 \\ \vec{r_3} \ \times\!\!= 20 \end{array}\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} 1& -5& 3 & 0 \\ -3& 2& 1 & 0 \\ 2& 3& -4 & 0 \end{array}\right] & \qquad \operatorname{swap} \vec{r_1}, \vec{r_2}\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} 1& -5& 3 & 0 \\ 0& -13& 10 & 0 \\ 0& 13& -10 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_2} \ +\!\!= 3\vec{r_1} \\ \vec{r_3} \ -\!\!= 2\vec{r_1} \end{array}\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} 13& -65& 39 & 0 \\ 0& -13& 10 & 0 \\ 0& 0& 0 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_3} \ +\!\!= \vec{r_2} \\ \vec{r_1} \ \times\!\!= 13 \end{array}\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} 13& 0& -11 & 0 \\ 0& -13& 10 & 0 \\ 0& 0& 0 & 0 \end{array}\right] & \qquad \vec{r_1} \ -\!\!= 5\vec{r_2}\\[NEWLINE][TAB]\left[\begin{array}{ccc|c} 1& 0& -\frac{11}{13} & 0 \\ 0& 1& -\frac{10}{13} & 0 \\ 0& 0& 0 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_1} \ \times\!\!= \frac{1}{13} \\ \vec{r_2} \ \times\!\!= -\frac{1}{13} \end{array}[NEWLINE]\end{align*}">$$\begin{align*}\left[\begin{array}{ccc|c} 0.85 - 1& 0.1& 0.05 & 0 \\ 0.05& 0.75 - 1& 0.15 & 0 \\ 0.1& 0.15& 0.8 - 1 & 0 \end{array}\right] &\\[4px]\left[\begin{array}{ccc|c} -0.15& 0.1& 0.05 & 0 \\ 0.05& -0.25& 0.15 & 0 \\ 0.1& 0.15& -0.2 & 0 \end{array}\right] &\\[4px]\left[\begin{array}{ccc|c} -3& 2& 1 & 0 \\ 1& -5& 3 & 0 \\ 2& 3& -4 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_1} \ \times\!\!= 20 \\ \vec{r_2} \ \times\!\!= 20 \\ \vec{r_3} \ \times\!\!= 20 \end{array}\\[4px]\left[\begin{array}{ccc|c} 1& -5& 3 & 0 \\ -3& 2& 1 & 0 \\ 2& 3& -4 & 0 \end{array}\right] & \qquad \operatorname{swap} \vec{r_1}, \vec{r_2}\\[4px]\left[\begin{array}{ccc|c} 1& -5& 3 & 0 \\ 0& -13& 10 & 0 \\ 0& 13& -10 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_2} \ +\!\!= 3\vec{r_1} \\ \vec{r_3} \ -\!\!= 2\vec{r_1} \end{array}\\[4px]\left[\begin{array}{ccc|c} 13& -65& 39 & 0 \\ 0& -13& 10 & 0 \\ 0& 0& 0 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_3} \ +\!\!= \vec{r_2} \\ \vec{r_1} \ \times\!\!= 13 \end{array}\\[4px]\left[\begin{array}{ccc|c} 13& 0& -11 & 0 \\ 0& -13& 10 & 0 \\ 0& 0& 0 & 0 \end{array}\right] & \qquad \vec{r_1} \ -\!\!= 5\vec{r_2}\\[4px]\left[\begin{array}{ccc|c} 1& 0& -\frac{11}{13} & 0 \\ 0& 1& -\frac{10}{13} & 0 \\ 0& 0& 0 & 0 \end{array}\right] & \qquad \begin{array}{l} \vec{r_1} \ \times\!\!= \frac{1}{13} \\ \vec{r_2} \ \times\!\!= -\frac{1}{13} \end{array}\end{align*}$$</span></p><p class="body-text">Now we have a vector of <span class="tex-holder inline-math" data-source-tex="\vec{q} = \left[\begin{array}{c} \frac{11}{13}t \\ \frac{10}{13}t \\ t \end{array}\right]">$\vec{q} = \left[\begin{array}{c} \frac{11}{13}t \\ \frac{10}{13}t \\ t \end{array}\right]$</span> for any value of <span class="tex-holder inline-math" data-source-tex="t">$t$,</span> and choosing <span class="tex-holder inline-math" data-source-tex="t = 13">$t = 13$,</span> we get <span class="tex-holder inline-math" data-source-tex="\left[\begin{array}{c} 11 \\ 10 \\ 13 \end{array}\right]">$\left[\begin{array}{c} 11 \\ 10 \\ 13 \end{array}\right]$.</span> That gives the relative amounts of students in each major, but we specifically need the sum of the entries to be <span class="tex-holder inline-math" data-source-tex="300">$300$.</span> The easiest way to make this happen is to first scale down the vector to have a sum of <span class="tex-holder inline-math" data-source-tex="1">$1$,</span> then multiply that by <span class="tex-holder inline-math" data-source-tex="300">$300$.</span> We can get the first one by dividing every entry by the total sum, which is <span class="tex-holder inline-math" data-source-tex="11 + 10 + 13 = 34">$11 + 10 + 13 = 34$,</span> to get</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\left[\begin{array}{c} \frac{11}{34} \\ \frac{10}{34} \\ \frac{13}{34} \end{array}\right],[NEWLINE]$$">$$\begin{align*}\left[\begin{array}{c} \frac{11}{34} \\ \frac{10}{34} \\ \frac{13}{34} \end{array}\right],\end{align*}$$</span></p><p class="body-text">then multiply by <span class="tex-holder inline-math" data-source-tex="300">$300$,</span> which results in</p><p class="body-text" style="text-align: center"><span class="tex-holder" style="padding: 8px" data-source-tex="$$[NEWLINE][TAB]\left[\begin{array}{c} \frac{3300}{34} \\ \frac{3000}{34} \\ \frac{3900}{34} \end{array}\right] \approx \left[\begin{array}{c} 97.1 \\ 88.2 \\ 114.7 \end{array}\right].[NEWLINE]$$">$$\begin{align*}\left[\begin{array}{c} \frac{3300}{34} \\ \frac{3000}{34} \\ \frac{3900}{34} \end{array}\right] \approx \left[\begin{array}{c} 97.1 \\ 88.2 \\ 114.7 \end{array}\right].\end{align*}$$</span></p><p class="body-text">So over time, the number of students in each major tends toward roughly 97, 88, and 115 in math, physics, and computer science, respectively.</p></div><div class="notes-exc notes-environment"><div class="notes-exc-title notes-title">Exercise: a steady-state solution</div><p class="body-text">With the previous computer OS exercise, what will the percentage of users with each OS be in the long run?</p></div><div class="text-buttons nav-buttons"><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button previous-nav-button" type="button" tabindex="-1">Previous</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button home-nav-button" type="button" tabindex="-1">Home</button></div><div class="focus-on-child" tabindex="1"><button class="text-button linked-text-button nav-button next-nav-button" type="button" tabindex="-1">Next</button></div></div></section></main>