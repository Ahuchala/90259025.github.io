import{Applet}from"../../../scripts/applets/applet.min.js";import{changeOpacity}from"/scripts/src/animation.min.js";import{convertColor}from"/scripts/src/browser.min.js";import{addTemporaryWorker}from"/scripts/src/main.min.js";import{siteSettings}from"/scripts/src/settings.min.js";import{WilsonCPU}from"/scripts/wilson.min.js";class SudokuGenerator extends Applet{grid=[];resolution=1809;webWorker;generatedFirstPuzzle=!1;constructor({canvas}){super(canvas);var t={canvasWidth:this.resolution};this.wilson=new WilsonCPU(canvas,t)}async run(){this.grid=new Array(9);for(let s=0;s<9;s++){this.grid[s]=new Array(9);for(let t=0;t<9;t++)this.grid[s][t]=0}this.generatedFirstPuzzle&&await changeOpacity({element:this.canvas,opacity:0}),this.wilson.ctx.clearRect(0,0,this.resolution,this.resolution),this.webWorker=addTemporaryWorker("/applets/sudoku-generator/scripts/worker.js"),this.webWorker.onmessage=e=>{this.grid=e.data[0],this.drawGrid(!1),this.generatedFirstPuzzle||changeOpacity({element:this.canvas,opacity:1}),this.generatedFirstPuzzle=!0},this.webWorker.postMessage([])}drawGrid(printMode){printMode?(this.wilson.ctx.fillStyle=convertColor(255,255,255),this.wilson.ctx.fillRect(0,0,this.resolution,this.resolution),this.wilson.ctx.fillStyle=convertColor(0,0,0)):(this.wilson.ctx.clearRect(0,0,this.resolution,this.resolution),siteSettings.darkTheme?this.wilson.ctx.fillStyle=convertColor(192,192,192):this.wilson.ctx.fillStyle=convertColor(64,64,64));for(let t=0;t<=9;t++)t%3==0&&(this.wilson.ctx.fillRect(200*t,0,10,this.resolution+9),this.wilson.ctx.fillRect(0,200*t,this.resolution+9,10)),this.wilson.ctx.fillRect(200*t+4,0,2,this.resolution+9),this.wilson.ctx.fillRect(0,200*t+4,this.resolution+9,2);for(let s=0;s<9;s++)for(let t=0;t<9;t++)this.wilson.ctx.font="150px sans-serif",0!==this.grid[s][t]&&this.wilson.ctx.fillText(this.grid[s][t],200*t+64,200*s+156)}}export{SudokuGenerator};