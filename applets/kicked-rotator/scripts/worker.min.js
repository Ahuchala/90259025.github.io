"use strict";let gridSize,K,orbitSeparation,image=[],currentRow,currentCol,currentP,currentTheta;function drawKickedRotator(){var r=Math.floor(gridSize/2);for(let a=1;a<gridSize/2;a+=orbitSeparation+1){image=new Array(gridSize*gridSize);for(let e=0;e<gridSize;e++)for(let r=0;r<gridSize;r++)image[gridSize*e+r]=0;var t=6/7*a/(gridSize/2),i=Math.floor(Math.random()*(2*orbitSeparation+1))-orbitSeparation,i=calculateOrbit(Math.floor(gridSize/2+a),r+i,t);if(-1!==i){if(i<.45)for(let e=0;e<gridSize;e++)for(let r=0;r<gridSize;r++)0!==image[gridSize*e+r]&&(image[gridSize*(gridSize-e-1)+gridSize-r-1]=image[gridSize*e+r]);postMessage([image,t])}}}function calculateOrbit(startRow,startCol){let r=0;if(currentRow=startRow,currentCol=startCol,0!==image[gridSize*currentRow+currentCol])return-1;currentP=(1-currentRow/gridSize)*(2*Math.PI),currentTheta=currentCol/gridSize*(2*Math.PI);let e=0;for(;image[gridSize*currentRow+currentCol]++,e++,currentRow<gridSize/2&&r++,300!==image[gridSize*currentRow+currentCol];){for(currentP+=K*Math.sin(currentTheta),currentTheta+=currentP;currentP>=2*Math.PI;)currentP-=2*Math.PI;for(;currentTheta>=2*Math.PI;)currentTheta-=2*Math.PI;for(;currentP<0;)currentP+=2*Math.PI;for(;currentTheta<0;)currentTheta+=2*Math.PI;currentRow=Math.floor((1-currentP/(2*Math.PI))*gridSize),currentCol=Math.floor(currentTheta/(2*Math.PI)*gridSize)}return r/e}onmessage=e=>{gridSize=e.data[0],K=e.data[1],orbitSeparation=e.data[2],drawKickedRotator()};