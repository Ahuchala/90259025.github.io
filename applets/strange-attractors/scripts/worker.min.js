"use strict";let gridSize,sigma,rho,beta,pixels=[];const boxSize=50,dt=5e-4,minZ=0;let stepsPerColor=5e3,numColors,currentX=1,currentY=1,currentZ=25,currentRow,currentCol;function drawLorenzAttractor(){let r=0,e=0;for(numColors=gridSize;0<stepsPerColor;){if(r===stepsPerColor){const o=HSVtoRGB(e/numColors/6.5,1,1);postMessage(pixels.map(p=>[p[0],p[1],o])),pixels=[],e++,r=0,stepsPerColor-=2*Math.floor(5e3/numColors)}var t=currentZ-minZ-boxSize/2;currentCol=Math.floor((currentX+boxSize/2)/boxSize*gridSize),0<=(currentRow=Math.floor((1-(t+boxSize/2)/boxSize)*gridSize))&&0<=currentCol&&currentRow<gridSize&&currentCol<gridSize&&pixels.push([currentRow,currentCol]),currentX+=sigma*(currentY-currentX)*dt,currentY+=(currentX*(rho-currentZ)-currentY)*dt,currentZ+=(currentX*currentY-beta*currentZ)*dt,r++}}function HSVtoRGB(h,s,v){let r,e,t;var o=Math.floor(6*h),n=6*h-o,a=v*(1-s),c=v*(1-n*s),u=v*(1-(1-n)*s);switch(o%6){case 0:r=v,e=u,t=a;break;case 1:r=c,e=v,t=a;break;case 2:r=a,e=v,t=u;break;case 3:r=a,e=c,t=v;break;case 4:r=u,e=a,t=v;break;case 5:r=v,e=a,t=c}return[Math.round(255*r),Math.round(255*e),Math.round(255*t)]}onmessage=e=>{gridSize=e.data[0],sigma=e.data[1],rho=e.data[2],beta=e.data[3],drawLorenzAttractor()};